<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Robot Framework &#33258;&#21160;&#21270;&#27979;&#35797;&#26694;&#26550;&#20351;&#29992;&#25351;&#23548;&#20070; </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Robot Framework &#33258;&#21160;&#21270;&#27979;&#35797;&#26694;&#26550;&#20351;&#29992;&#25351;&#23548;&#20070; ">
    <meta name="generator" content="docfx 2.59.3.0">
    
    <link rel="shortcut icon" href="../../../favicon.ico">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="robot-framework-自动化测试框架使用指导书">Robot Framework 自动化测试框架使用指导书</h1>

<blockquote><p>版次：2022年8月22日　第2版
类型：技术文件
部门：软件部
上层文件: 软件测试规范
上海维宏电子科技股份有限公司　版权所有</p>
</blockquote>
<table>
<thead>
<tr>
<th>文件版本</th>
<th>修改前文件版本</th>
<th>主要修订内容和原因</th>
<th>修订人</th>
<th>修订日期</th>
</tr>
</thead>
<tbody>
<tr>
<td>R1</td>
<td></td>
<td>新建</td>
<td>余晓霞</td>
<td>2022/1/5</td>
</tr>
<tr>
<td>R2</td>
<td>R1</td>
<td>1、修改自动化测试用例组织指导的范例；<br>2、添加测试用例维护的基本原则和案例分析</td>
<td>余晓霞</td>
<td>2022/8/22</td>
</tr>
</tbody>
</table>
<h2 id="1-目的和范围">1 目的和范围</h2>
<p>本指导书就使用 Robot Framework 自动化框架实施自动化测试提供指导。</p>
<h2 id="2-robot-framework-介绍">2 Robot Framework 介绍</h2>
<h3 id="21-自动化测试介绍">2.1 自动化测试介绍</h3>
<p>自动化测试是相对于手工测试而存在的，主要是通过所开发的软件测试工具、脚本等来实现模拟手工操作。具有良好的可操作行、可重复性和高效性等特点。自动化测试是软件测试中提高测试效率、覆盖率和可靠性的重要测试手段。</p>
<h3 id="22-robot-framework-介绍">2.2 Robot Framework 介绍</h3>
<p>Robot Framework 是一个开源的，基于 Python 的，可扩展的关键字驱动的测试自动化框架，用于端到端验收测试和验收测试驱动开发（ATDD），在自动化测试领域被广泛应用。</p>
<h2 id="3-自动化测试框架">3 自动化测试框架</h2>
<h3 id="31-自动化测试框架设计思想">3.1 自动化测试框架设计思想</h3>
<p>自动化测试框架以统一的自动化工作模式、测试资产库的不断积累为设计思想。</p>
<ul>
<li><strong>统一的自动化工作模式</strong></li>
</ul>
<p>自动化测试框架本身固化了一套自动化脚本设计、自动化脚本开发、扩展开发和调度执行的模式和规范，保证了自动化测试实施技术和方法的一致性，降低了自动化测试对具体人员的依赖性，也在一定的程度上减少了因为人员经验技能的差异导致的自动化效果差异。</p>
<ul>
<li><strong>测试资产库不断积累</strong></li>
</ul>
<p>自动化测试框架注重自动化测试资产的积累、共享和复用。在自动化测试过程中产生的业务关键字、通用关键字、业务流、测试脚本、对象库、测试数据等资产进行有效的组织和存储，并在不同的测试中实现复用。</p>
<h3 id="32-自动化测试框架逻辑架构">3.2 自动化测试框架逻辑架构</h3>
<p>自动化测试框架逻辑架构如下图（1）所示：</p>
<p><img src="images/image-20220105144707179.png" alt="image-20220105144707179"></p>
<blockquote><p><strong>图（1）说明：</strong></p>
<ul>
<li><strong>Robot Resources</strong>：基于 Robot Framework 语法定义的关键字或资源</li>
<li><strong>Python Resources</strong>：使用 python 定义的关键字资源。</li>
<li><strong>Custom Keyworks</strong>：自定义的关键字，例如：业务通用关键字、工具类关键字、UI操作关键字。</li>
<li><strong>UI 对象库</strong>：存储 GUI 对象的 Xpath 信息；</li>
<li><strong>Stadard Library</strong>：与 Robot Framework 一起分发的测试库，例如： BuiltIn、String、OperatingSystem等。</li>
<li><strong>WeihongLibrary</strong>：根据公司产品特点定义的第三方类库。例如：FlaUILibrary，里面包含的功能有：GUI 的操作、Phoenix 软件的通信、Phoenix 软件日志的查询等。</li>
</ul>
</blockquote>
<h3 id="33-自动化测试框架使用指导">3.3 自动化测试框架使用指导</h3>
<h4 id="331-自动化测试环境">3.3.1 自动化测试环境</h4>
<ul>
<li>开发语言：Robot Framework、Python；</li>
<li>Python 版本：3.8.10 （32位）；</li>
<li>Robot Framework 版本：3.2.2；</li>
<li>平台：Windows System；</li>
</ul>
<p>环境部署操作指导见 <a href="http://wiki.weihong.com/pages/viewpage.action?pageId=21332362">wiki(内网)《环境部署》</a></p>
<h4 id="332-自动化测试代码管理">3.3.2 自动化测试代码管理</h4>
<p>自动化测试代码的目录结构如下所示：</p>
<pre><code class="lang-bash">自动化测试项目/
├── action  #项目通用资源层
│   ├── common   #通用关键字
│   │   └── assert.robot #自定义断言关键字文件
│   │   ├── 多语言兼容.robot
│   └── NcConfig  # NcConfig 项目通用资源
│       ├── GUI     #页面资源
│            ├──pages
│                ├── 机床部件.robot     #机床部件页面
│                    ├── 打开配置窗口  #关键字
│                    ├── 在组件配置窗口选择组件    #关键字
│                ├── 页面元素.robot     # 页面控件元素 xpath 维护文件
│   └── Laser  # 激光平面项目通用资源
│       ├── GUI #页面资源
│            ├──pages
│                ├── 启动.robot   #激光应用程序启动
│                    ├── 启动应用程序  #关键字
│                ├── 页面元素.robot     # 页面控件元素 xpath 维护文件
│       ├── Phoenix         #项目的 Phoenix 寻址或 API 接口维护模块
├── application/libs        #测试框架运行相关的工具包
│   ├── TestServer.dll  #被测软件通信包
│   ├── TestServer.toc  #被测软件通信包  
│   └──  AutoTest.CIEngine.exe   #自动化安装部署被测软件工具 
├── data    #测试数据
│   ├── NcFiles  #刀路文件
├── docs    #文件集合
│   ├── keyword.html  #flaui 关键字说明文档
│   ├── readme.md   #自动化项目说明文档
├── utils   # Python 定义的关键字或工具集合
│   ├── SQLLitePlugin.py  #SQLLite 相关的关键字
│   ├── FileHandler.py  #文件操作相关的关键字
│   ├── Register.py     #被测软件注册工具
├── testcase    #测试用例
│   ├── 安装    #功能/功能模块
│   │   └── Test_安装_UI.robot     #用例套件文件，文件命名格式：Test_功能模块_功能[_其它].robot 中括号部分为可选项。
│               ├── 按默认选项安装软件   #测试用例
│   └── 回机械原点  #功能/功能模块
│       ├── Test_机床准备_回机械原点_API.robot   #用例套件文件
│           ├── 绝对值模式且关闭辅助设定基准功能执行单轴回，检测回机械原点结束后位置是否正确  #测试用例
│           ├── 绝对值模式且关闭辅助设定基准功能执行单轴回，检测回机械原点的速度是否正确    #测试用例
│           ├── ...
│   └── ...
</code></pre><p><strong>说明：</strong></p>
<ul>
<li><strong>action</strong>： 项目通用资源层，用于维护通用业务关键字、通用工具关键字或页面关键字。</li>
<li><strong>application</strong> ：用于存放测试框架运行相关的工具包，例如与应用程序通信相关的 TestServer.dll，或部署自动化测试环境相关的 AutoTest.CIEngine.exe 等。</li>
<li><strong>data</strong>： 用于存放测试数据。例如刀路文件。</li>
<li><strong>docs</strong> ：用于存放相关文档，例如关键字的说明文档，或其他文档。</li>
<li><strong>testcase</strong> ：属于用例层，存放测试用例脚本文件。</li>
<li><strong>utils</strong>：  python 定义的关键字或工具类</li>
</ul>
<h4 id="333-自动化测试用例执行流程">3.3.3 自动化测试用例执行流程</h4>
<p>用例执行流程如下图（3）所示：</p>
<p><img src="images/image2021-8-18_16-22-19.png" alt="image2021-8-18_16-22-19.png"></p>
<p>图（3）</p>
<p>用例内部执行流程如下图（4）所示：</p>
<p><img src="images/image-20220105180137494.png" alt="image-20220105180137494"></p>
<p>图（4）</p>
<h2 id="4-自动化测试用例组织指导">4 自动化测试用例组织指导</h2>
<h3 id="41-测试用例维护的基本原则">4.1 测试用例维护的基本原则</h3>
<blockquote><p>只有消灭重复的无关紧要细节，让测试清晰表达被测系统功能职责，才能在发生系统需求和实现变更的情况下轻松应对以便降低自动化测试维护的成本。</p>
<p>------  来源：Dale H. Emery 《Writing Maintainable Automated Acceptance Tests》</p>
</blockquote>
<p>为了满足此基本原则，需要做到如下三点：</p>
<ol>
<li><p>细节：隐藏无关紧要的细节。</p>
</li>
<li><p>重复：消除重复。</p>
<p>抽取业务通用关键字，通常是消除重复的有效措施。因此要求编写自动化测试用例前，应该对功能业务进行梳理，同时了解系统的通用功能或操作。</p>
<p>1、项目关键字，项目关键字适用于整个项目</p>
<blockquote><p>4.1 章节优化后的案例中“打开刀路文件”的关键字是系统的通用操作，因为不仅空运行功能执行前需要加载文件，其它很多功能（例如：开始加工、寻边等）执行前也需要加载文件，所以此关键字应该定义为项目关键字（在项目 Action（或 Common）层定义的关键字），而非当前的套件关键字（在测试套件里定义的关键字）。</p>
</blockquote>
<p>2、套件关键字，套件关键字适用于当前测试套件</p>
</li>
<li><p>命名：给每一个动作、变量或标题等的本质赋予具有意义的名称。例如测试脚本中含有意义的变量名、关键字和测试用例标题。<strong>命名基本原则，如下所示：</strong></p>
<ul>
<li>优先使用中文命名；</li>
<li>若存在专业术语，则建议使用专业术语命名，勿自创新名词；</li>
<li><strong>命名清晰，且要体现本质的意义</strong>；</li>
<li>测试套件、测试用例标题、关键字、变量和文档描述的命名格式和规范建议遵循 Robot Framework 官方文档<a href="https://github.com/robotframework/HowToWriteGoodTestCases/blob/master/HowToWriteGoodTestCases.rst#documentation">《How To Write Good TestCase》</a></li>
<li>命名格式规范优先遵循公司的《软件测试规范》。</li>
<li>Robot Framework 执行后，测试报告和测试日志展示的用例标题的格式为：测试套件名称.测试用例标题。例如：测试套件 Test_空运行.robot 里的测试用例“场景测试：空运行 -&gt; 停止 -&gt; 前进 -&gt;后退 -&gt;断点继续”执行后，报告和日志展示的用例标题为：Test_空运行.场景测试：空运行 -&gt; 停止 -&gt; 前进 -&gt;后退 -&gt;断点继续；</li>
<li>项目关键字套件里，当定义的关键字只允许当前套件使用时，加 private 前缀，例如：private_激活列表元素。</li>
</ul>
</li>
</ol>
<h3 id="42-测试套件结构">4.2 测试套件结构</h3>
<p>Robot Framework 测试套件主要分为：Setting、Variable、Test Cases、Keywords 四个模块，如下所示。四个模块没有依赖关系。</p>
<pre><code class="lang-python">*** Settings ***
#套件设置，但不仅限于此
#引入库模块，例如：Library               RPA.Windows
#引入资源文件，包括变量和自定义的关键字，例如：Resource           ../../action/allImports.robot
#执行测试套件的测试用例前，执行初始化操作，例如：Suit Setup        系统环境初始化
#执行每个测试用例前，执行初始化操作，例如：Test Setup        用例执行前环境初始化
#执行每个测试用例后，执行环境清理操作，例如：Suite Teardown   用例执行后环境清理
#设置所有用例的标签，例如：Force Tags      自动应用工艺
*** Variables ***
#套件常量定义
${停止加工指令}         Phoenix.G.Ch0.Auto.Stop
*** Test Cases ***
#测试用例模块，顶格的行属于测试用例标题，缩进的内容为测试用例详情
TC001_自动应用工艺设置界面UI验证
    #测试用例详情
*** Keywords ***
#自定义关键字
系统环境初始化
    #关键字定义
用例执行前环境初始化
    #关键字定义
用例执行后环境清理
    #关键字定义
</code></pre><h3 id="43-gui-自动化测试范例">4.3 GUI 自动化测试范例</h3>
<h4 id="431-维护对象库">4.3.1 维护对象库</h4>
<p>在应用程序（子项目）的GUI模块里维护对象库，对象库维护方式有如下两种：</p>
<p>1、在统一的页面元素文件里维护所有的页面元素定位信息，例如：安装项目 UI 对象的 xpath 维护在 <strong>action\Installer\GUI\页面元素.robot</strong> 文件文件中。如下所示：</p>
<blockquote><p>xpath 可通过 FlaUInspect.exe(不仅限于工具) 获取；工具可在<a href="http://wiki.weihong.com/pages/viewpage.action?pageId=27728089">内外wiki</a>下载。</p>
</blockquote>
<pre><code class="lang-python">*** Variables ***
######################选择安装语言
${语言选择框}          //ComboBox[@AutomationId=&#39;cbxLanguage&#39;] \| //ComboBox[@AutomationId=&#39;languageComboBox&#39;]
${请选择安装时使用语言}     //Text[@AutomationId=&#39;tbPrompt&#39;]
${确定按钮}           //Button[@AutomationId=&#39;btnOK&#39;]
${取消按钮}           //Button[@AutomationId=&#39;btnCancel&#39;]
${安装程序_主页}    /Window[contains(@Name,&#39;安装程序 - NcStudio&#39;)]
${安装程序_语言选择页}    /Window[contains(@Name,{0})]
${安装程序_语言选择页_提示语}    ${安装程序_语言选择页}/Text[@AutomationId=&#39;tbPrompt&#39;]
${安装程序_语言选择页_语言下拉列表}    ${安装程序_语言选择页}/ComboBox[@AutomationId=&#39;languageComboBox&#39;]

######################安装警告
${安装程序_安装警告页}    ${安装程序_主页}/Window[contains(@Name,&#39;安装警告&#39;)]
${安装程序_安装警告页_提示文本框}    ${安装程序_安装警告页}/Edit
</code></pre><p>2、把页面元素维护在其对应页面的里。</p>
<h4 id="412-维护页面控件操作的动作">4.1.2 维护页面控件操作的动作</h4>
<p>把页面控件操作的动作定义在对应的页面动作文件里，每个页控件操作的动作，宜放在相同的一个 robot 文件里，不同页面控件操作的动作，宜放在其对应的单独页面里。例如：安装过程的选择语言页的页面动作，定义在 <strong>action\Installer\GUI\pages</strong>\选择语言页 .robot 文件里。如下所示：</p>
<pre><code class="lang-python">*** Settings ***        #robotframework 的设置模块，通常用于引入第三方库或资源等
Documentation     安装过程语言选择页的页面控件操作的动作定义     #文档说明，可用于说明此文件的适用范围或背景信息等
Library           FlaUILibrary                  #引入 FlaUILibrary 库
Resource          ../页面元素.robot              #引入资源文件页面元素.robot
*** Keywords ***    #定义页面相关的关键字。无缩进的行是关键字名称（即函数名称），紧随其下缩进两个空格的行的集合为函数体
获取界面语言      #关键字名称
    ${XPath_Chn}=   字符串格式化    ${安装程序_语言选择页}    安装   
    ${Exists_Chn}=  Run Keyword And Return Status  Element Should Exist  ${XPath_Chn}
    ${IntfLang}=    Set Variable If    ${Exists_Chn}    chn    eng
    [Return]    ${IntfLang}     #返回值

选择语言        #关键字名称
    [Documentation]    ${SpecLang}：指定的语言 #文档说明标签，用于说明关键的描述或背景等信息，在执行日志文件中会被打印
    [Arguments]    ${SpecLang}      # 传参定义
    Select Combobox Item By Name    ${安装程序_语言选择页_语言下拉列表}    ${SpecLang}
    Press Key    s&#39;ENTER&#39;

在语言选择对话框单击【确认】按钮    #关键字名称
    click   ${确定按钮}

选择语言并确定         #关键字名称
    [Arguments]    ${SpecLang}
    选择语言
    在语言选择对话框单击【确认】按钮
</code></pre><h4 id="423-测试用例样例">4.2.3 测试用例样例</h4>
<p>测试用例文件是在 <strong>testcase</strong> 目录下维护，例如: 安装应用程序的测试套件 Test_安装_UI.robot 的部分脚本如下所示：</p>
<pre><code class="lang-python">*** Settings ***        #设置模块，引入包和资源。设置测试准备和测试后环境清理
Library           FlaUILibrary
Resource          ../common/allImports.robot
Suite Setup       清理安装环境

*** Variables ***       #变量模块
${InstallConfig}    总线
${AppName}   ncstudio

*** Test Cases ***      #用例模块。无缩进的行为用例标题（即测试函数），紧随其下缩进两个空格的行的集合为测试步骤和预期结果集合
TC001_验证按默认选项安装         #用例标题
    [Tags]   P1     冒烟      通用必测    测试类型=功能     #用例标签
    ${datetime0}    ToolsPlugin.get current time        
    #测试步骤
    启动安装应用程序                                        
    选择语言页.选择语言并确定                                
    选择本地参数页.选择本地参数操作方式并确定                   
    安装完成页.等待安装完成                                 
    #预期结果
    验证应用程序文件修改时间大于等于    ${datetime0}        
    验证默认配置名称为    ${InstallConfig}               

*** Keywords ***
# 关键字模块，可自定义关键字，此处定义的关键字，适用范围为当前文件
</code></pre><blockquote><p>说明：</p>
<ul>
<li><p>Test_安装_UI.robot ： 是一个测试套件文件，包含有若干测试用例的集合文件。文件的命名格式为：文件命名格式：Test_[功能模块]_功能_[其它]，其中中括号“[ ]” 里的内容为可选项。</p>
</li>
<li><p>Setting 模块：是 Robot Framework测试套件文件的设置模块，适用范围为此测试套件文件，例如：引入资源和第三方库、声明 Setup 或 Teardown 等；</p>
</li>
<li>Variable 模块：是 Robot Framework 测试套件文件的变量声明模块，适用范围为此测试套件文件。</li>
<li>测试用例模块：*** Test Case *** 分隔线下的模块属于测试用例模块。用例标题格式和用例标签定义遵循《软件测试用例设计规范》 。</li>
<li>关键字模块：*** Keywords *** 分隔线下的模块属于关键字模块，此处定义的关键字使用范围为此测试套件文件。</li>
</ul>
</blockquote>
<h3 id="43-api-自动化测试范例">4.3 API 自动化测试范例</h3>
<p>测试用例样例如下：</p>
<pre><code class="lang-python">*** Settings ***
Documentation     测试需求依据或出处：XXXXX文档
...
...               Author: yxx
*** Variables ***
${停止加工}         Phoenix.G.Ch0.Auto.Stop
${X轴机械坐标}       Phoenix.G.Channels[${channel}].Axes[0].Position
*** Test Cases ***
场景测试：空运行 -&gt; 停止 -&gt; 前进 -&gt;后退 -&gt;断点继续
    [Documentation]    验证空运行停止，且操作前进后退后，可以正常进行断点继续
    ...   Author:余晓霞&lt;yuxiaoxia&gt;
    [Tags]    general    p1
    开刀路文件  test002.ncex
    执行空运行运动正常
    执行停止操作正常
    执行连续前进运动正常
    执行连续后退运行正常
    执行断点继续正常
    验证空运行过程中和结束后表现正确    
*** Keywords ***
执行停止操作正常
     set phoenix    ${停止加工}    true
     等待&#39;5s&#39;直到是空闲状态
执行连续前进运动正常
    ${x0}    get phoenix    ${X轴机械坐标}
    按下前进按钮
    等待&#39;5s&#39;直到是运行状态
    sleep    1s
    释放弹起鼠标右键
    等待&#39;1s&#39;直到是空闲状态
    ${x1}    get phoenix    ${X轴机械坐标}
    should be true    ${x0}&lt;${x1}
执行连续后退运行正常
    ${x0}    get phoenix    ${X轴机械坐标}
    按下后退按钮
    等待&#39;5s&#39;直到是运行状态
    sleep    1s
    释放弹起鼠标右键
    等待&#39;1s&#39;直到是空闲状态
    ${x1}    get phoenix    ${X轴机械坐标}
    should be true    ${x0}&gt;${x1}
执行断点继续正常
    ${x0}    get phoenix    ${X轴机械坐标}
    ${y0}    get phoenix    ${Y轴机械坐标}
    按下断点继续按钮
    等待&#39;5s&#39;直到是运行状态
    sleep    1s
    ${x1}    get phoenix    ${X轴机械坐标}
    ${y1}    get phoenix    ${Y轴机械坐标}
    Log    检查坐标发生运动
    should not be equal    ${x0}    ${x1}
    should not be equal    ${y0}    ${y1}
    验证Z轴不动
验证空运行过程中和结束后表现正确 
    空运行过程，检查Z轴不动和非真实加工
    等待空运行结束后，检查轨迹图    
空运行过程，检查Z轴不动和非真实加工
    验证Z轴不动
    ${isRealTask}    get Phoenix    ${真实加工}
    should not be true    ${isRealTask}
等待空运行结束后，检查轨迹图
    等待&#39;300s&#39;直到是空闲状态
    验证加工轨迹
</code></pre><h3 id="44-数据驱动测试范例">4.4 数据驱动测试范例</h3>
<h4 id="441-定义测试模板">4.4.1 定义测试模板</h4>
<p>测试模板是在需要使用不同的输入或输出数据来测试相同的场景时而产生的，其运行机制支持使用同一个测试模板自动遍历测试不同的数据。</p>
<p>在关键字模块里定义模板，模板的定义方式和关键字的定义方式相同，如下所示：</p>
<pre><code class="lang-python">*** Keywords ***    #关键字模块
导入并保存不同格式的文件            #关键字名称，类易于我们常说的函数
    [Arguments]    ${filename}    ${unit}    ${except_complete_time}   #传参
    [Timeout]    10 minutes  #超时设置，若执行时长超过10分钟，则超时退出
    #操作步骤
    导入文件    ${filename}    ${unit}    ${except_complete_time}
    验证文件导入(打开)成功    ${filename}
    保存文件    savefile.ncex
    验证导入文件后保存成功
导入文件
    [Arguments]    ${filename}    ${unit}    ${except_complete_time}
    ${执行用例前系统最新1条警告日志}    最新&#39;1&#39;条Warning日志
    ${执行用例前系统最新1条错误日志}    最新&#39;1&#39;条Error日志
    set suit variable  ${执行用例前系统最新1条警告日志}
    set suit variable  ${执行用例前系统最新1条错误日志}
    导入文件    ${filename}    ${unit}    ${except_complete_time}
保存文件
    [Arguments]    ${filename}
    保存文件   ${filename}
    sleep    1s
    ${执行操作后系统最新1条警告日志}    最新&#39;1&#39;条Warning日志
    ${执行操作后系统最新1条错误日志}    最新&#39;1&#39;条Error日志
    set suit variable  ${执行保存文件操作后系统最新1条警告日志}
    set suit variable  ${执行保存文件操作后系统最新1条错误日志}
验证导入文件后保存成功
    文件应该被保存成功    ${filename}
    should be equal  ${执行用例前系统最新1条警告日志}  ${执行操作后系统最新1条警告日志}  保存过程中出现告警日志
    should be equal  ${执行用例前系统最新1条错误日志}  ${执行操作后系统最新1条错误日志}  保存过程中出现错误日志
</code></pre><h4 id="442-数据驱动测试用例样例">4.4.2 数据驱动测试用例样例</h4>
<pre><code class="lang-python">*** Settings ***
Template    导入并保存不同格式的文件
Force Tags    p2    通用必测
*** Test Cases ***            #加工文件名称           文件单位    预计导入完成所需时间（s）
使用英制单位导入dxf文件          5层2.dxf               英制单位      2
使用公制单位导入lxd文件          4001.lxd              公制单位       5
使用公制单位dwg文件            保险耳板.dwg             公制单位       3
使用英制单位nc文件             飞行切割.nc              英制单位       2   
使用公制单位dxf文件           不锈钢切割发送.dxf         公制单位       10
使用公制单位plt文件            鸿基.plt                公制单位       5
</code></pre><h3 id="45-案例分析">4.5 案例分析</h3>
<p>Robot Framework 主要用于做验收测试，验收测试主要是用来验证系统的某一特定功能是否实现正确。以下给出的反例主要是用来验证业务场景：空运行 -&gt; 停止 -&gt; 前进 -&gt;后退 -&gt;断点继续。但是下列中的测试验证脚本写得很糟糕。优化后的范例可查看 4.3 章节《 API 自动化测试范例》</p>
<p><strong>主要存在如下几个问题：</strong></p>
<ol>
<li>可读性很低，很难理解。<ul>
<li>用例名称描述不够清晰明确；</li>
<li>用例步骤过长，且没有清晰的表述出测试场景的执行步骤，应该隐藏一些无关紧要的细节，例如：“释放弹起鼠标右键”等。</li>
</ul>
</li>
<li>测试套件的文档( Documentation ) 信息里重复了测试套件名称（Test_空运行.robot）可以看出的信息。</li>
</ol>
<pre><code class="lang-python">*** Settings ***
Documentation     验证空运行功能.
...
...               Author: yxx

*** Variables ***
${停止加工指令}         Phoenix.G.Ch0.Auto.Stop
${X轴机械坐标寻址}       Phoenix.G.Channels[${channel}].Axes[0].Position
*** Test Cases ***
空运行—功能-验证空运行过程中触发停止后可执行前进 后退 断点继续
    [Documentation]    Author:余晓霞&lt;yuxiaoxia&gt;
    [Tags]    general    p1    suit1    skip
    Log    前置条件：空运行运动中
    ${ncfile_path}    get ncfile path    test002.ncex
    文件操作_UI_AUTO.打开加工文件    ${ncfile_path}
    按下空运行按钮
    等待&#39;5s&#39;直到是运行状态
    #运行3s
    sleep    3s
    Log    执行测试
    Log    验证停止
    set phoenix    ${停止加工指令}    true
    等待&#39;5s&#39;直到是空闲状态
    Log    验证前进
    ${x0}    get phoenix    ${X轴机械坐标寻址}
    按下前进按钮
    sleep    1s
    释放弹起鼠标右键
    ${x1}    get phoenix    ${X轴机械坐标寻址}
    should not be equal    ${x0}    ${x1}
    #按下停止按钮
    等待&#39;1s&#39;直到是空闲状态
    Log    验证前进之后断点继续功能可用
    按下断点继续按钮
    等待&#39;5s&#39;直到是运行状态
    按下停止按钮
    Log    验证后退
    ${x0}    get phoenix    ${X轴机械坐标寻址}
    按下后退按钮
    sleep    1s
    释放弹起鼠标右键
    ${x1}    get phoenix    ${X轴机械坐标寻址}
    should not be equal    ${x0}    ${x1}
    等待&#39;1s&#39;直到是空闲状态
    Log    验证后退之后断点继续功能可用
    ${x0}    get phoenix    ${X轴机械坐标寻址}
    ${y0}    get phoenix    ${Y轴机械坐标寻址}
    按下断点继续按钮
    等待&#39;5s&#39;直到是运行状态
    sleep    1s
    ${x1}    get phoenix    ${X轴机械坐标寻址}
    ${y1}    get phoenix    ${Y轴机械坐标寻址}
    Log    检查坐标发生运动
    should not be equal    ${x0}    ${x1}
    should not be equal    ${y0}    ${y1}
    验证Z轴不动
    Log    检查不是真实加工
    ${isRealTask}    get Phoenix    ${真实加工寻址}
    should not be true    ${isRealTask}
    Log    验证运行结束后的加工轨迹
    等待&#39;300s&#39;直到是空闲状态
    验证加工轨迹
</code></pre><h2 id="5-工具介绍">5 工具介绍</h2>
<p>支持 Robot Framework 的 IDE 工具有很多，例如： RobotFramework-ride、Pycharm、VS Code、IntelliJ 等。可根据个人使用习惯进行选择，相关工具的使用指导，在网络上都可以找到。</p>
<h3 id="51-集成开发工具---robotframework-ride">5.1 集成开发工具 - RobotFramework-ride</h3>
<p>RobotFramework-ride 是 Robot Framework 提供的集成开发工具，属于开源项目，可使用ride 编写测试用例和执行测试用例，其中编写用例提供了 GUI 页面编写和文本模式编写两种方式。优点支持关键字自动补全和语法检测、执行用例、新手入门快等，缺点是没有集成版本管理工具（例如： Git、TFS 等）和不适用 Python 的开发和调试。</p>
<p>对于 RobotFramework-ride 的使用手册可在<a href="http://wiki.weihong.com/pages/viewpage.action?pageId=27728089">wiki(内网) 《测试工具集》</a>获取。网上也有很多关于ride 的使用指导，这里不再对其的使用指导做介绍。</p>
<h3 id="52-集成开发工具---pycharm">5.2 集成开发工具 - PyCharm</h3>
<p>PyCharm 是 Python 的集成开发环境。PyCharm 安装包，及支持 Robot Framework 用例的执行的插件 intelllibot.jar 的安装指导，可在<a href="http://wiki.weihong.com/pages/viewpage.action?pageId=27728089">wiki（内网）《测试工具集》</a>获取。</p>
<h2 id="6-执行测试">6 执行测试</h2>
<h3 id="61-命令行执行">6.1 命令行执行</h3>
<p>在命令执行 Robot Framework 测试用例，可使用 robot 命令。如下只对其常用的命令做说明，其它命令选项说明可使用帮助命令 “ robot -h ” 查看。</p>
<ol>
<li><p>执行一个用例</p>
<pre><code class="lang-bash">robot -t &quot;测试用例名称&quot; 测试套件文件.robot
</code></pre></li>
<li><p>按用例文件执行</p>
<pre><code class="lang-bash">robot 测试套件文件.robot
</code></pre></li>
<li><p>执行目录下的所有用例</p>
<pre><code class="lang-bash">robot 测试套件文件目录
</code></pre></li>
<li><p>按 tag 执行用例</p>
<pre><code class="lang-bash">robot -i P1ANDSmoking -e SkipORLS3000 测试套件文件目录
</code></pre><blockquote><p>-i :  表示包含；</p>
<p>-e：表示排除；</p>
<p>AND：表示逻辑与关系；</p>
<p>OR：表示逻辑或关系；</p>
<p>命令意思是：执行同时包含 P1 和 Smoking 标签的用例，并且排除包含有 Skip 或 Ls3000 的标签的用例。标签的值大小写敏感。</p>
</blockquote>
</li>
<li><p>变量参数</p>
<pre><code class="lang-bash">robot --variable env:仿真  --variable install_package_name:Setup-Gen-NC60A-15.550.14.1_Beta.exe 测试套件文件目录
</code></pre></li>
</ol>
<h3 id="62-ci-执行">6.2 CI 执行</h3>
<p>CI 是基于 Jenkins 实现的。Jenkins 地址：<a href="http://172.16.10.40:8080/；使用域账号登录。操作步骤如下：">http://172.16.10.40:8080/；使用域账号登录。操作步骤如下：</a></p>
<p>1、在任务（job）列表单击任务名称，进入任务详情页；</p>
<p>2、单击左侧导航栏的【Build whith parameters】，右侧展示构建参数信息</p>
<p>3、录入构建参数信息，单击【开始构建】按钮，若执行机空闲，则立即开始执行自动化测试，否则等待到执行机空闲之后才开始执行自动化测试。</p>
<p>5、构建结果或其他信息可通过构建详情页查看，如下图（5）所示。</p>
<p><img src="images/image-20220106110358935.png" alt="image-20220106110358935">图（5）</p>
<blockquote><p><strong>经验谈</strong>：</p>
<p>当想查看构建过程日志时，在构建详情页通过右侧的菜单按钮【控制台输出】查看构建过程日志，控制台输出功能提供构建过程日志的实时输出。</p>
</blockquote>
<h2 id="7-查看日志和测试报告">7 查看日志和测试报告</h2>
<p>Robot Framework 提供有 html 页面查看执行日志（log.html）和测试报告(report.html)。</p>
<p><img src="images/image-20220106111135212.png" alt="image-20220106111135212"></p>
<p>图（6）测试报告</p>
<p> 编制：余晓霞                          审核：                                批准：</p>
<p>  审批链接：</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/weihong-phoenix/docfx_build/blob/main/doc/&#30740;&#21457;&#31649;&#29702;&#21046;&#24230;&#35268;&#33539;/&#27979;&#35797;&#31649;&#29702;&#35268;&#33539;/Robot Framework &#33258;&#21160;&#21270;&#27979;&#35797;&#26694;&#26550;&#20351;&#29992;&#25351;&#23548;&#20070;.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            Shanghai Weihong Electronic Technology Co., Ltd.
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
    
      </body>
</html>
